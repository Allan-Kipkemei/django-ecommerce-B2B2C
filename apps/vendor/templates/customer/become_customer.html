{% extends 'core/base.html' %}
{% load i18n %}
{% block title %}Set up a Customer account{% endblock %}

{% block content %}
<div class="site__body">
   
       <div class="container">
            <div class="row justify-content-center">
            <div class="col-xl-5 col-lg-6 col-md-8">
                <div class="card flex-grow-1 mb-0 mt-5">
                    <div class="card-body">
                        <h3 class="card-title">{% trans 'Set up a Customer account' %}</a></h3>
                        <form method="post" action="." enctype="multipart/form-data">
                           {% csrf_token %}
                           <input type="hidden" name="next" value="{{ next }}">
                           <div class="field form-group">
                                <div class="control" style="display: none;">
                                    <input type="text" name="username" id="id_username" value="username">
                                </div>
                           </div>

                            <div class="field form-group">
                               <label>{% trans 'First name & Last name' %}</label>
                               <div class="control">
                                   <input type="text" class="input form-control" name="customername" id="id_customername">
                               </div>
                           </div>
                           
                           <div class="field form-group">
                               <label>{% trans 'Email' %}</label>
                               <div class="control">
                                   <input type="email" class="input form-control" name="email" id="id_email">
                               </div>
                           </div>
                        
                           <div class="field form-group">
                               <label>{% trans 'TIN (optional)' %}</label>
                               <div class="control">
                                   <input type="text" class="input form-control" name="company_code" id="id_company_code">
                               </div>
                           </div>
                           <div class="field form-group">
                               <label>{% trans 'Phone' %}</label>
                               <div class="control">
                                   <input type="text" class="input form-control" name="phone" id="id_phone" >
                               </div>
                           </div>
                           <div class="field form-group" id="district">
                            <label>{% trans 'District' %}</label>
    
                            <div class="control">
                                <select class="select form-control" name="district" id="id_district">
                                    <option value="" selected>{% trans '---Select District---' %}</option>
                                    {% for entry in districts %}
                                    <option value="{{ entry.id }}">{{ entry.district }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
    
                        <div class="field form-group" id="sector">
                            <label>{% trans 'Sector' %}</label>
    
                            <div class="control">
                                <select class="select form-control" name="sector" id="id_sector">
                                    <option value="" selected>{% trans '---Select Sector---' %}</option>
                                </select>
                            </div>
                        </div>
    
                        <div class="field form-group" id="cell">
                            <label>{% trans 'Cell' %}</label>
    
                            <div class="control">
                                <select class="select form-control" name="cell" id="id_cell">
                                    <option value="" selected>{% trans '---Select Cell---' %}</option>
                                </select>
                            </div>
                        </div>
    
                        <div class="field form-group" id="village">
                            <label>{% trans 'Village' %}</label>
    
                            <div class="control">
                                <select class="select form-control" name="village" id="id_village">
                                    <option value="" selected>{% trans '---Select Village---' %}</option>
                                </select>
                            </div>
                        </div>
                        <div class="field form-group" id="address">
                            <label>{% trans 'Address' %}</label>
                            <div class="control">
                                <input type="text" class="input form-control" name="address" id="id_address">
                            </div>
                        </div>
                           <div class="field form-group">
                               <label>{% trans 'Password' %}</label>
                               <input type="password" class="input form-control" name="password1" id="id_password1" >
                           </div>
                           <div class="field form-group">
                               <label>{% trans 'Confirm Password' %}</label>
                               <div class="control">
                                   <input type="password" class="input form-control" name="password2" id="id_password2">
                               </div>
                           </div>
                           <div class="field form-group">
                               <div class="control">
                                   <input type="checkbox" name="is_privacy" value="True" id="is_privacy" required/>
                                  <label>{% trans 'I agree to' %} Sokopark's <a href="{% url 'termsandconditions' %}">{% trans 'Terms & Conditions' %}</a>.</label>
                               </div>
                           </div>
                           <div class="field form-group">
                               <div class="control">
                                   <button type="submit" class="btn btn-primary btn-lg btn-block">{% trans 'Register' %}</button>
                               </div>
                           </div>
                       </form>
                        <label class="form-check-label" for="login-remember">{% trans 'Already have account' %}? <a href="{% url 'login' %}"> {% trans 'Sign in here' %} </a>
                        <label class="form-check-label" for="login-remember">{% trans 'Register as vendor' %}? <a href="{% url 'become_vendor' %}"> {% trans 'Register here' %} </a> 
                        <label class="form-check-label" for="login-remember">{% trans 'Register a Service' %} ? <a href="{% url 'become-service-provider' %}"> {% trans 'Register here' %} </a> 
                    </div>
                </div>
            </div>
        </div>
        </div>
 </div>
 
 <script>
    var district = document.getElementById('district');
    var district_sel = document.getElementById('id_district');

    var sector = document.getElementById('sector');
    var sector_sel = document.getElementById('id_sector');

    var cell = document.getElementById('cell');
    var cell_sel = document.getElementById('id_cell');

    var village = document.getElementById('village');
    var village_sel = document.getElementById('id_village');

    var address = document.getElementById('address');
    var textArea = document.getElementById('id_address');
    delivery_shown();
    function store_shown() {
        district.style.display = 'none';
        district_opt = document.createElement("option")
        district_opt.value = -1;
        district_sel.appendChild(district_opt);
        district_sel.selectedIndex = 1;

        sector.style.display = 'none';
        sector_opt = document.createElement("option")
        sector_opt.value = -1;
        sector_sel.appendChild(sector_opt);
        sector_sel.selectedIndex = 1;

        cell.style.display = 'none';
        cell_opt = document.createElement("option")
        cell_opt.value = -1;
        cell_sel.appendChild(cell_opt);
        cell_sel.selectedIndex = 1;

        village.style.display = 'none';
        village_opt = document.createElement("option")
        village_opt.value = -1;
        village_sel.appendChild(village_opt);
        village_sel.selectedIndex = 1;

        address.style.display = 'none';
        textArea.value = "*****";

        cost.style.display = 'none';
        cost_sel.selectedIndex = 0;

        delivery_opt.checked = false;
    }

    function delivery_shown() {
        district.style.display = 'block';
        district_sel.selectedIndex = 0;

        // cost.style.display = 'block';
        // cost_sel.selectedIndex = 0;

        sector.style.display = 'none';
        sector_sel.selectedIndex = 0;

        cell.style.display = 'none';
        cell_sel.selectedIndex = 0;

        village.style.display = 'none';
        village_sel.selectedIndex = 0;

        address.style.display = 'none';
        textArea.value = "";
    }

    district_sel.onchange = function(){
        if (this.value == "") {
            cell.style.display = 'none';
            village.style.display = 'none';
            address.style.display = 'none';
        }

        sector_sel.selectedIndex = 0;
        sector.style.display = (this.value == "") ? "none":"block";
    };
    sector_sel.onchange = function(){
        if (this.value == "") {
            village.style.display = 'none';
            address.style.display = 'none';
        }

        cell_sel.selectedIndex = 0;
        cell.style.display = (this.value == "") ? "none":"block";
    };
    cell_sel.onchange = function(){
        if (this.value == "") {
            address.style.display = 'none';
        }
        village_sel.selectedIndex = 0;
        village.style.display = (this.value == "") ? "none":"block";
    };
    village_sel.onchange = function(){
        textArea.value = "";
        address.style.display = (this.value == "") ? "none":"block";
    };
</script>

 <script >
         $("#id_district").change(function () {
             var districtId = $(this).val();
             if (districtId != '') {
                 $.ajax({
                     url: "{% url 'district_sector' %}",
                     data: {
                         'districtId': districtId
                     },
                     success: function (data) {
                         $("#cell").hide();
                         $("#village").hide();
 
                         var html_data = '<option value="" selected>---Select Sector---</option>';
                         data.forEach(function (data) {
                             html_data += `<option value="${data.id}">${data.sector}</option>`
                         });
                         $("#id_sector").html(html_data);
 
                     }
                 });
             }
         });
 
         $("#id_sector").change(function () {
             var districtId = $("#id_district").val();
             var sectorId = $(this).val();
 
             if (sectorId != '') {
                 $.ajax({
                     url: "{% url 'district_sector_cell' %}",
                     data: {
                         'districtId': districtId,
                         'sectorId': sectorId
                     },
                     success: function (data) {
                         $("#village").hide();
 
                         var html_data = '<option value="" selected>---Select Cell---</option>';
                         data.forEach(function (data) {
                             html_data += `<option value="${data.id}">${data.cell}</option>`
                         });
                         $("#id_cell").html(html_data);
                     }
                 });
             }
         });
 
         $("#id_cell").change(function () {
             var districtId = $("#id_district").val();
             var sectorId = $("#id_sector").val();
             var cellId = $(this).val();
 
             if (cellId != '') {
                 $.ajax({
                     url: "{% url 'district_sector_cell_village' %}",
                     data: {
                         'districtId': districtId,
                         'sectorId': sectorId,
                         'cellId': cellId
                     },
                     success: function (data) {
                         var html_data = '<option value="" selected>---Select Village---</option>';
                         data.forEach(function (data) {
                             html_data += `<option value="${data.id}">${data.village}</option>`
                         });
                         $("#id_village").html(html_data);
                     }
                 });
             }
         });
     </script>
{% endblock %}